<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" xmlns:contacts="com.dbi.cat.view.contacts.*" xmlns:components="com.dbi.cat.view.components.*">
	<mx:Script>
		<![CDATA[
			import com.dbi.cat.common.constants.EntryPointType;
			import com.dbi.cat.common.vo.ClientVO;
			import com.dbi.controls.AdvancedComboBox;
			import mx.collections.ArrayCollection;
			import com.dbi.cat.common.vo.ContactTagVO;
			import com.dbi.util.DateUtil;
			import mx.controls.dataGridClasses.DataGridColumn;
			import com.dbi.cat.common.vo.ContactVO;
			
			[Bindable]
			public var clients:ArrayCollection;
			
			[Bindable]
			public var contacts:ArrayCollection;
			
			private function createDateLabel(contact:ContactVO, column:DataGridColumn):String
			{
				return DateUtil.formatDate(contact.createDate);
			}
			private function tagListLabel(contact:ContactVO, column:DataGridColumn):String
			{
				var ret:String = "";
				for each (var tag:ContactTagVO in contact.contactTags)
				{
					if (ret.length > 0)
						ret += ", ";
					ret += tag.tag;
				}
				return ret;
			}
		]]>
	</mx:Script>
	<mx:HDividedBox left="0" right="0" top="0" bottom="0">
		<mx:Canvas width="100%" height="100%">
			<mx:HBox width="100%" verticalAlign="middle"
				top="5">
				<mx:Label text="Client:"/>
				<components:FormattedComboBox
					id="Client"
					top="4" left="55"
					bindingBehavior="{AdvancedComboBox.BINDING_BEHAVIOR_FIRST}"
					labelField="name"
					dataProvider="{clients}" />
				<mx:Label text="Type:" />
				<mx:ComboBox id="ContactType"
					dataProvider="{EntryPointType.getAllTypes()}" />
				<mx:Label text="Contact:" />
				<mx:TextInput id="Contact" />
			</mx:HBox>
			<mx:DataGrid id="Contacts"
				width="100%" height="100%" top="30"
				dataProvider="{contacts}">
				<mx:columns>
					<mx:DataGridColumn headerText="Contact" dataField="address" />
					<mx:DataGridColumn headerText="Date Added" labelFunction="createDateLabel" />
					<mx:DataGridColumn headerText="Tags" labelFunction="tagListLabel" />
				</mx:columns>
			</mx:DataGrid>
		</mx:Canvas>
		<contacts:TagView top="0" bottom="0" right="0"
			selectedClient="{Client.selectedItem as ClientVO}"
			width="150" />
	</mx:HDividedBox>
</mx:Canvas>
